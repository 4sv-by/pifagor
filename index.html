<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="js/datepicker.min.css" />
    <link
      rel="stylesheet"
      type="text/css"
      href="css/main2.min.css"
      media="screen, projection, print"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      rel="stylesheet"
    />
    <title>Квадрат Піфагора</title>
  </head>

  <body>
    <div class="matrix">
      <div class="wrapper matrix__wrapper">
        <div class="matrix__form">
          <div class="calc-container-column calc-container-column_header">
            <div class="calc-inps-header mb-5">
              <div class="calc-inps-header-row">
                <span> Iмʼя:</span>
                <input
                  type="text"
                  name="calc-matriza-name"
                  placeholder="Ваше ім'я"
                  id="calc-matriza-name"
                  class="calc-inp-matriza"
                />
              </div>
              <div class="calc-inps-header-row">
                <span>Дата народження:</span>
                <input
                  data-mask="00.00.0000"
                  type="tel"
                  name="calc-matriza-bd"
                  id="calc-matriza-bd"
                  placeholder="01.01.1990"
                  class="calc-inp-matriza matrix__input matrix_date"
                />
              </div>
            </div>
          </div>
        </div>
        <div class="result">
          <div class="result__hidden">
            <div class="result__wrap">
              <div class="flex flex-col wrap gap-4" id="contentToSave">
                <b
                  id="userNameInPdf"
                  style="
                    color: black;
                    font-size: 24px;
                    width: 100%;
                    text-align: center;
                  "
                ></b>
                <div class="flex flex-col gap-4">
                  <div class="result__left">
                    <div class="result__big">
                      <div class="result__row result__flex">
                        <div class="result__info">
                          <i class="fas fa-calendar-alt"></i> Народження
                        </div>
                        <div class="result__answer" data-answer="date"></div>
                      </div>
                      <div class="result__row result__flex">
                        <div class="result__info">
                          <i class="fas fa-plus-circle"></i> Дод. числа
                        </div>
                        <div
                          class="result__answer"
                          data-answer="second-number"
                        ></div>
                      </div>
                      <div class="result__row result__flex">
                        <div class="result__info">
                          <i class="fas fa-star"></i> Число життєвого шляху
                        </div>
                        <div
                          class="result__answer"
                          data-answer="destiny-number"
                        ></div>
                      </div>
                    </div>
                    <div class="result__cube">
                      <div class="result__row">
                        <div class="result__item">
                          <div class="result__context">
                            <h4>Характер</h4>
                            <p data-index="0" class="kv_1"></p>
                          </div>
                        </div>
                        <div class="result__item">
                          <div class="result__context">
                            <h4>Здоров'я</h4>
                            <p data-index="3" class="kv_2"></p>
                          </div>
                        </div>
                        <div class="result__item">
                          <div class="result__context">
                            <h4>Удача</h4>
                            <p data-index="6" class="kv_3"></p>
                          </div>
                        </div>
                      </div>

                      <div class="result__row">
                        <div class="result__item">
                          <div class="result__context">
                            <h4>Енергія</h4>
                            <p data-index="1" class="kv_4"></p>
                          </div>
                        </div>
                        <div class="result__item">
                          <div class="result__context">
                            <h4>Логіка</h4>
                            <p data-index="4" class="kv_5"></p>
                          </div>
                        </div>
                        <div class="result__item">
                          <div class="result__context">
                            <h4>Обов'язок</h4>
                            <p data-index="7" class="kv_6"></p>
                          </div>
                        </div>
                      </div>

                      <div class="result__row">
                        <div class="result__item">
                          <div class="result__context">
                            <h4>Інтерес</h4>
                            <p data-index="2" class="kv_7"></p>
                          </div>
                        </div>
                        <div class="result__item">
                          <div class="result__context">
                            <h4>Праця</h4>
                            <p data-index="5" class="kv_8"></p>
                          </div>
                        </div>
                        <div class="result__item">
                          <div class="result__context">
                            <h4>Пам'ять</h4>
                            <p data-index="8" class="kv_9"></p>
                          </div>
                        </div>
                      </div>

                      <div class="result__row">
                        <div class="result__item0">
                          <div class="result__context">
                            <p class="d_p3"></p>
                          </div>
                        </div>
                        <div class="result__item0">
                          <div class="result__context">
                            <p data-index="10" class="d_p4"></p>
                          </div>
                        </div>
                        <div class="result__item0">
                          <div class="result__context">
                            <p class="d_p2"></p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="result__right">
                    <div class="result__item result__item_full">
                      <div class="result__context">
                        <h4 class="top">
                          <i class="fas fa-user-astronaut"></i> Темперамент
                        </h4>
                        <p data-index="9" class="kv_10"></p>
                      </div>
                    </div>
                    <div class="result__item result__item_full">
                      <div class="result__context">
                        <h4 class="top">
                          <i class="fas fa-bullseye"></i> Ціль
                        </h4>
                        <p data-index="12" class="kv_11"></p>
                      </div>
                    </div>
                    <div class="result__item result__item_full">
                      <div class="result__context">
                        <h4 class="top"><i class="fas fa-users"></i> Сім'я</h4>
                        <p data-index="11" class="kv_12"></p>
                      </div>
                    </div>
                    <div class="result__item result__item_full">
                      <div class="result__context">
                        <h4 class="top">
                          <i class="fas fa-sync-alt"></i> Звички
                        </h4>
                        <p data-index="13" class="kv_13"></p>
                      </div>
                    </div>
                    <div class="result__item result__item_full">
                      <div class="result__context">
                        <h4 class="result__info">
                          <i class="fas fa-peace"></i> Духовність
                        </h4>
                        <p class="d_p1"></p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="flex col-reverse justify-between">
                <section id="pifagor-square" class="container">
                  <h3 class="text-center">Квадрат Піфагора</h3>

                  <div class="content">
                    <p>
                      Квадрат Піфагора — це числова матриця, що базується на
                      нумерології, де кожне число має свою енергетичну та
                      символічну значимість. Він створений на основі дати
                      народження людини і розкладає числа у певній
                      послідовності, що дозволяє визначити особистісні
                      характеристики, сильні та слабкі сторони, а також
                      потенціал розвитку.
                    </p>
                  </div>
                </section>

                <div class="w-full flex gap-4 flex-col">
                  <div class="primary-button">
                    <a href="#cta" class="scrollbtn"
                      ><span>ЗАМОВИТИ РОЗБІР КВАДРАТА</span></a
                    >
                  </div>

                  <div class="primary-button">
                    <a id="savePdfBtn" class="disabled">
                      <span>Зберегти в PDF</span>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br />
    <br />

    <br />
    <br />

    <script src="js/jquery.min.js"></script>
    <script src="js/jquery.mask.min.js"></script>
    <!-- Підключаємо jQuery -->
    <!-- <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> -->

    <!-- Підключаємо jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Підключаємо html2pdf для легшого конвертування HTML в PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.js"></script>

    <script src="js/main.min.js"></script>

    <script>
      document
        .querySelector(".scrollbtn")
        .addEventListener("click", function (event) {
          event.preventDefault();

          window.parent.postMessage("scrollToAnchor", "*");
        });

      window.addEventListener("load", function () {
        const iframeHeight = document.body.scrollHeight;
        window.parent.postMessage(
          { type: "iframeHeight", height: iframeHeight },
          "*"
        );
      });
    </script>

    <script>
      $(document).ready(function () {
        // Перевірка полів
        function validateFields() {
          const name = $("#calc-matriza-name").val().trim();
          const birthDate = $("#calc-matriza-bd").val().trim();
          const isMatrixFilled =
            $(".kv_1").text().trim() !== "" &&
            $(".kv_2").text().trim() !== "" &&
            $(".kv_3").text().trim() !== "";

          if (birthDate && isMatrixFilled) {
            $("#savePdfBtn").removeClass("disabled").css({
              "pointer-events": "auto",
              opacity: 1,
            });
          } else {
            $("#savePdfBtn").addClass("disabled").css({
              "pointer-events": "none",
              opacity: 0.5,
            });
          }
        }

        // Відстеження змін у полях
        $("#calc-matriza-name, #calc-matriza-bd").on("input", validateFields);

        // Перевірка заповнення матриці (припускаємо, що матриця заповнюється автоматично)
        setInterval(validateFields, 500);

        // Кнопка для збереження в PDF
        $("#savePdfBtn").click(function () {
          const userName = $("#calc-matriza-name").val();
          const nameElement = document.getElementById("userNameInPdf");
          if (userName !== "") {
            nameElement.textContent = `Квадрат Піфагора для: ${userName}`;
          }

          const element = document.getElementById("contentToSave");
          html2pdf()
            .from(element)
            .set({
              filename: `${userName}_особистий_Квадрат_Піфагора_від_Вікторії_Гонч.pdf`,
              orientation: "landscape",
              margin: [10, 10, 10, 10],
            })
            .save();
        });
      });
    </script>
  </body>
</html>
